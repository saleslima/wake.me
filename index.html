<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Sistema de Transporte e Alerta</title>
    <!-- √çcones para PWA -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üöá</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üöá</text></svg>">
    <link rel="manifest" href="data:application/json,{
        'name': 'Sistema de Transporte SP',
        'short_name': 'TransporteSP',
        'description': 'Sistema de alerta para esta√ß√µes de transporte',
        'start_url': '/',
        'display': 'standalone',
        'background_color': '#1a237e',
        'theme_color': '#4a148c',
        'icons': [
            {
                'src': 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><rect width=\"100\" height=\"100\" rx=\"20\" fill=\"%234a148c\"/><text x=\"50\" y=\"70\" font-family=\"Arial\" font-size=\"60\" text-anchor=\"middle\" fill=\"white\">üöá</text></svg>',
                'sizes': '100x100',
                'type': 'image/svg+xml'
            }
        ]
    }">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
            -webkit-text-size-adjust: 100%;
        }
        
        html {
            font-size: 16px;
        }
        
        body {
            background: linear-gradient(135deg, #1a237e, #4a148c);
            color: #fff;
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 10px;
            width: 100%;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            background: rgba(255, 255, 255, 0.1);
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            color: #bb86fc;
            line-height: 1.3;
            word-wrap: break-word;
        }
        
        .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            line-height: 1.4;
            padding: 0 5px;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        /* Layout responsivo para tablets e desktops */
        @media (min-width: 768px) {
            html {
                font-size: 17px;
            }
            
            .container {
                padding: 15px;
            }
            
            header {
                padding: 20px;
                margin-bottom: 25px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .main-content {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 25px;
            }
        }
        
        @media (min-width: 1024px) {
            html {
                font-size: 18px;
            }
            
            h1 {
                font-size: 2.8rem;
            }
            
            .main-content {
                gap: 30px;
            }
        }
        
        .section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.1);
            width: 100%;
            overflow: hidden;
        }
        
        @media (min-width: 768px) {
            .section {
                padding: 25px;
            }
        }
        
        .section-title {
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: #bb86fc;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .section-title i {
            font-size: 1.2rem;
        }
        
        @media (min-width: 768px) {
            .section-title {
                font-size: 1.6rem;
                margin-bottom: 20px;
            }
            
            .section-title i {
                font-size: 1.4rem;
            }
        }
        
        .buttons-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .transport-btn {
            background: linear-gradient(to right, #6200ea, #3700b3);
            color: white;
            border: none;
            padding: 16px 20px;
            font-size: 1.1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
            width: 100%;
            touch-action: manipulation;
            min-height: 60px;
        }
        
        .transport-btn:active {
            transform: scale(0.98);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        @media (min-width: 768px) {
            .transport-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
                background: linear-gradient(to right, #3700b3, #6200ea);
            }
            
            .transport-btn:active {
                transform: scale(0.98);
            }
        }
        
        .transport-btn i {
            font-size: 1.2rem;
        }
        
        .btn-content {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }
        
        .btn-arrow {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .back-btn {
            background: linear-gradient(to right, #616161, #9e9e9e);
            padding: 10px 15px;
            border-radius: 8px;
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            width: 100%;
            justify-content: center;
            touch-action: manipulation;
        }
        
        .back-btn:active {
            transform: scale(0.98);
        }
        
        .options-container {
            max-height: 50vh;
            overflow-y: auto;
            padding: 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin-bottom: 15px;
            display: none;
            -webkit-overflow-scrolling: touch;
        }
        
        /* Estiliza√ß√£o da scrollbar para mobile */
        .options-container::-webkit-scrollbar {
            width: 6px;
        }
        
        .options-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .options-container::-webkit-scrollbar-thumb {
            background: #bb86fc;
            border-radius: 10px;
        }
        
        .option-item {
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            touch-action: manipulation;
            user-select: none;
        }
        
        .option-item:active {
            transform: scale(0.98);
            background: rgba(255, 255, 255, 0.2);
        }
        
        @media (min-width: 768px) {
            .option-item:hover {
                background: rgba(255, 255, 255, 0.2);
                transform: translateX(5px);
            }
        }
        
        .line-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .line-color {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        
        .station-item {
            padding-left: 25px;
            position: relative;
        }
        
        .station-item:before {
            content: "‚óè";
            position: absolute;
            left: 10px;
            color: #bb86fc;
            font-size: 0.8rem;
        }
        
        .selected {
            background: rgba(187, 134, 252, 0.3);
            border-left: 4px solid #bb86fc;
        }
        
        .address-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .form-row {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        @media (min-width: 480px) {
            .form-row {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        label {
            font-weight: 600;
            color: #bb86fc;
            font-size: 0.9rem;
        }
        
        input, select {
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 1rem;
            width: 100%;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        
        select {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 20px;
            padding-right: 45px;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #bb86fc;
            box-shadow: 0 0 0 2px rgba(187, 134, 252, 0.2);
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 14px 25px;
            font-size: 1.1rem;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex: 1;
            min-width: 200px;
            max-width: 100%;
            touch-action: manipulation;
        }
        
        .action-btn:active {
            transform: scale(0.98);
        }
        
        .confirm-btn {
            background: linear-gradient(to right, #00c853, #64dd17);
            color: white;
        }
        
        @media (min-width: 768px) {
            .confirm-btn:hover {
                background: linear-gradient(to right, #00e676, #00c853);
                transform: translateY(-3px);
                box-shadow: 0 5px 15px rgba(0, 200, 83, 0.4);
            }
        }
        
        .alarm-section {
            grid-column: 1 / -1;
            text-align: center;
        }
        
        .alarm-controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
        }
        
        @media (min-width: 480px) {
            .alarm-controls {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
                align-items: center;
                gap: 15px;
            }
        }
        
        .alarm-btn {
            padding: 12px 20px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 160px;
            max-width: 100%;
            touch-action: manipulation;
        }
        
        .alarm-btn:active {
            transform: scale(0.98);
        }
        
        @media (min-width: 768px) {
            .alarm-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }
        }
        
        .alarm-on {
            background: linear-gradient(to right, #ff3d00, #ff9100);
            color: white;
        }
        
        .alarm-off {
            background: linear-gradient(to right, #616161, #9e9e9e);
            color: white;
        }
        
        .alarm-status {
            padding: 10px 15px;
            border-radius: 50px;
            font-weight: 600;
            margin-top: 10px;
            display: inline-block;
            font-size: 0.9rem;
            text-align: center;
            width: 100%;
            max-width: 400px;
        }
        
        .alarm-active {
            background: rgba(255, 61, 0, 0.2);
            color: #ffab91;
            animation: pulse 2s infinite;
        }
        
        .alarm-inactive {
            background: rgba(158, 158, 158, 0.2);
            color: #e0e0e0;
        }
        
        .status-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        
        @media (min-width: 480px) {
            .status-container {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
                padding: 15px;
            }
        }
        
        .status-item {
            text-align: center;
            flex: 1;
        }
        
        .status-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: #bb86fc;
            margin-top: 5px;
            word-break: break-word;
            line-height: 1.3;
        }
        
        @media (min-width: 768px) {
            .status-value {
                font-size: 1.2rem;
            }
        }
        
        .notification {
            position: fixed;
            bottom: 15px;
            left: 15px;
            right: 15px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.95);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border-left: 5px solid #bb86fc;
            display: none;
            z-index: 1000;
            animation: slideIn 0.5s ease;
            max-width: 500px;
            margin: 0 auto;
        }
        
        @media (min-width: 768px) {
            .notification {
                bottom: 30px;
                right: 30px;
                left: auto;
                max-width: 350px;
            }
        }
        
        @keyframes slideIn {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .notification h3 {
            color: #bb86fc;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .notification-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
        }
        
        .alarm-sound {
            display: none;
        }
        
        .loading {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #bb86fc;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.8rem;
            opacity: 0.8;
            line-height: 1.4;
        }
        
        .selection-path {
            font-size: 0.85rem;
            color: #bb86fc;
            margin-bottom: 10px;
            padding: 8px 12px;
            background: rgba(187, 134, 252, 0.1);
            border-radius: 8px;
            display: none;
            word-wrap: break-word;
            line-height: 1.4;
        }
        
        .location-info {
            margin-top: 15px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            display: none;
        }
        
        .location-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }
        
        @media (min-width: 480px) {
            .location-details {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }
        }
        
        .location-item {
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            font-size: 0.85rem;
            word-break: break-word;
        }
        
        .location-label {
            color: #bb86fc;
            font-weight: 600;
            margin-bottom: 3px;
            font-size: 0.8rem;
        }
        
        .distance-indicator {
            height: 10px;
            background: linear-gradient(to right, #00c853, #ffeb3b, #ff3d00);
            border-radius: 5px;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .distance-progress {
            height: 100%;
            background: #bb86fc;
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 5px;
        }
        
        .distance-marker {
            position: absolute;
            height: 15px;
            width: 2px;
            background: white;
            top: -2px;
        }
        
        .distance-marker-200 {
            left: 80%;
        }
        
        .distance-marker-100 {
            left: 90%;
        }
        
        .distance-marker-50 {
            left: 95%;
        }
        
        .distance-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.65rem;
            margin-top: 5px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .map-container {
            margin-top: 15px;
            border-radius: 10px;
            overflow: hidden;
            height: 200px;
            background: rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        @media (min-width: 768px) {
            .map-container {
                height: 250px;
            }
        }
        
        .map-placeholder {
            text-align: center;
            padding: 15px;
        }
        
        .map-placeholder i {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #bb86fc;
        }
        
        .distance-warning {
            color: #ff3d00;
            font-weight: bold;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .auto-monitoring-btn {
            background: linear-gradient(to right, #2196F3, #21CBF3);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
            margin-top: 15px;
            width: 100%;
            touch-action: manipulation;
        }
        
        .auto-monitoring-btn:active {
            transform: scale(0.98);
        }
        
        @media (min-width: 768px) {
            .auto-monitoring-btn:hover {
                background: linear-gradient(to right, #1976D2, #2196F3);
            }
        }
        
        .monitoring-active {
            background: linear-gradient(to right, #4CAF50, #8BC34A) !important;
        }
        
        /* Melhorias espec√≠ficas para telas muito pequenas */
        @media (max-width: 360px) {
            html {
                font-size: 15px;
            }
            
            .transport-btn {
                padding: 14px 15px;
                font-size: 1rem;
                min-height: 55px;
            }
            
            .action-btn {
                min-width: 100%;
                padding: 12px 20px;
            }
            
            .status-value {
                font-size: 1rem;
            }
        }
        
        /* Otimiza√ß√£o para orienta√ß√£o paisagem */
        @media (max-height: 500px) and (orientation: landscape) {
            .options-container {
                max-height: 40vh;
            }
            
            .transport-btn {
                padding: 12px 15px;
                min-height: 50px;
            }
        }
        
        /* Prevenir zoom em inputs no iOS */
        @media (max-width: 768px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }
        
        /* Melhorias de toque para iOS */
        button, .option-item, .transport-btn {
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Prevenir highlight azul em elementos toc√°veis no iOS */
        button, a, input, select, textarea, .option-item {
            -webkit-tap-highlight-color: rgba(0,0,0,0);
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Melhorar legibilidade em diferentes telas */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #0d1b5e, #2a0c5c);
            }
        }
        
        /* Ajustes para telas muito grandes */
        @media (min-width: 1400px) {
            .container {
                max-width: 95%;
            }
        }
        
        /* Garantir que elementos n√£o transbordem */
        .section, .options-container, .notification {
            max-width: 100%;
            box-sizing: border-box;
        }
        
        /* Ajustes para o painel de simula√ß√£o */
        #simulationSpeed {
            width: 100%;
            margin-top: 8px;
            padding: 10px;
        }
        
        .simulation-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        @media (min-width: 480px) {
            .simulation-controls {
                flex-direction: row;
                align-items: center;
            }
            
            #simulationSpeed {
                flex: 1;
                margin-top: 0;
            }
        }
        
        /* Ajuste para o bot√£o de fechar notifica√ß√£o em telas pequenas */
        @media (max-width: 767px) {
            .notification-close {
                width: 40px;
                height: 40px;
                font-size: 1.8rem;
            }
        }
        
        /* Ajuste para instru√ß√µes em telas pequenas */
        .instructions-box {
            margin-top: 15px;
            padding: 12px;
            background: rgba(255, 61, 0, 0.1);
            border-radius: 10px;
            font-size: 0.85rem;
        }
        
        .instructions-box h4 {
            font-size: 1rem;
            margin-bottom: 8px;
            color: #ffab91;
        }
        
        .instructions-box p {
            margin-bottom: 6px;
            line-height: 1.4;
        }
        
        /* Instru√ß√µes para instalar PWA */
        .pwa-install-btn {
            background: linear-gradient(to right, #FF4081, #F50057);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
            margin-top: 15px;
            width: 100%;
            touch-action: manipulation;
        }
        
        .pwa-install-btn:active {
            transform: scale(0.98);
        }
        
        .pwa-instructions {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 64, 129, 0.1);
            border-radius: 10px;
            border-left: 4px solid #FF4081;
        }
        
        .pwa-instructions h4 {
            color: #FF4081;
            margin-bottom: 10px;
        }
        
        .pwa-instructions ul {
            padding-left: 20px;
            margin-bottom: 10px;
        }
        
        .pwa-instructions li {
            margin-bottom: 8px;
            font-size: 0.85rem;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo-icon">üöá</div>
                <div>
                    <h1>Sistema de Transporte SP</h1>
                    <p class="subtitle">Metr√¥ e CPTM com alerta de proximidade (200m)</p>
                </div>
            </div>
            <button class="pwa-install-btn" id="installPWA">
                <i class="fas fa-download"></i> Instalar App no Celular
            </button>
            <div id="pwaInstructions" class="pwa-instructions">
                <h4><i class="fas fa-mobile-alt"></i> Como instalar:</h4>
                <ul>
                    <li><strong>Android Chrome:</strong> Toque em "Instalar App" ou ‚ãÆ ‚Üí "Adicionar √† tela inicial"</li>
                    <li><strong>iPhone Safari:</strong> Toque em <i class="fas fa-share"></i> ‚Üí "Adicionar √† Tela de In√≠cio"</li>
                    <li><strong>Outros navegadores:</strong> Procure por "Instalar aplicativo" ou "Adicionar √† tela inicial"</li>
                </ul>
                <p>Ap√≥s instalar, o app aparecer√° com √≠cone üöá na sua tela inicial!</p>
            </div>
        </header>
        
        <div class="main-content">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-train"></i> Op√ß√µes de Transporte</h2>
                
                <div id="selectionPath" class="selection-path"></div>
                
                <div class="buttons-container">
                    <button class="transport-btn" id="cptmBtn">
                        <div class="btn-content">
                            <i class="fas fa-train"></i>
                            <span>CPTM / ViaMobilidade</span>
                        </div>
                        <div class="btn-arrow"><i class="fas fa-chevron-right"></i></div>
                    </button>
                    
                    <button class="transport-btn" id="metroBtn">
                        <div class="btn-content">
                            <i class="fas fa-subway"></i>
                            <span>Metr√¥ de S√£o Paulo</span>
                        </div>
                        <div class="btn-arrow"><i class="fas fa-chevron-right"></i></div>
                    </button>
                    
                    <button class="transport-btn" id="addressBtn">
                        <div class="btn-content">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Cadastrar Endere√ßo</span>
                        </div>
                        <div class="btn-arrow"><i class="fas fa-chevron-right"></i></div>
                    </button>
                </div>
                
                <!-- Container para linhas do Metr√¥ -->
                <div id="metroLines" class="options-container">
                    <h3>üöá Linhas do Metr√¥ de S√£o Paulo</h3>
                    <div class="option-item line-item" data-type="metro" data-line="Linha 1 ‚Äì Azul">
                        <div class="line-color" style="background-color: #005CA9;"></div>
                        <div>
                            <strong>Linha 1 ‚Äì Azul</strong>
                            <div>Jabaquara ‚Üî Tucuruvi</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="metro" data-line="Linha 2 ‚Äì Verde">
                        <div class="line-color" style="background-color: #00AA5B;"></div>
                        <div>
                            <strong>Linha 2 ‚Äì Verde</strong>
                            <div>Vila Prudente ‚Üî Vila Madalena</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="metro" data-line="Linha 3 ‚Äì Vermelha">
                        <div class="line-color" style="background-color: #EE3F23;"></div>
                        <div>
                            <strong>Linha 3 ‚Äì Vermelha</strong>
                            <div>Corinthians-Itaquera ‚Üî Palmeiras-Barra Funda</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="metro" data-line="Linha 4 ‚Äì Amarela">
                        <div class="line-color" style="background-color: #FFD100;"></div>
                        <div>
                            <strong>Linha 4 ‚Äì Amarela</strong>
                            <div>Luz ‚Üî Vila S√¥nia</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="metro" data-line="Linha 5 ‚Äì Lil√°s">
                        <div class="line-color" style="background-color: #8B499A;"></div>
                        <div>
                            <strong>Linha 5 ‚Äì Lil√°s</strong>
                            <div>Cap√£o Redondo ‚Üî Ch√°cara Klabin</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="metro" data-line="Linha 15 ‚Äì Prata">
                        <div class="line-color" style="background-color: #A9A9A9;"></div>
                        <div>
                            <strong>Linha 15 ‚Äì Prata</strong>
                            <div>Vila Prudente ‚Üî Jardim Colonial</div>
                        </div>
                    </div>
                </div>
                
                <!-- Container para esta√ß√µes do Metr√¥ -->
                <div id="metroStations" class="options-container"></div>
                
                <!-- Container para linhas da CPTM -->
                <div id="cptmLines" class="options-container">
                    <h3>üöÜ Linhas da CPTM / ViaMobilidade</h3>
                    <div class="option-item line-item" data-type="cptm" data-line="Linha 7 ‚Äì Rubi">
                        <div class="line-color" style="background-color: #A60C1E;"></div>
                        <div>
                            <strong>Linha 7 ‚Äì Rubi</strong>
                            <div>Br√°s ‚Üî Jundia√≠</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="cptm" data-line="Linha 8 ‚Äì Diamante">
                        <div class="line-color" style="background-color: #00A65A;"></div>
                        <div>
                            <strong>Linha 8 ‚Äì Diamante</strong>
                            <div>J√∫lio Prestes ‚Üî Itapevi</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="cptm" data-line="Linha 9 ‚Äì Esmeralda">
                        <div class="line-color" style="background-color: #0C9444;"></div>
                        <div>
                            <strong>Linha 9 ‚Äì Esmeralda</strong>
                            <div>Osasco ‚Üî Varginha</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="cptm" data-line="Linha 10 ‚Äì Turquesa">
                        <div class="line-color" style="background-color: #0D7AB8;"></div>
                        <div>
                            <strong>Linha 10 ‚Äì Turquesa</strong>
                            <div>Br√°s ‚Üî Rio Grande da Serra</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="cptm" data-line="Linha 11 ‚Äì Coral">
                        <div class="line-color" style="background-color: #F58220;"></div>
                        <div>
                            <strong>Linha 11 ‚Äì Coral</strong>
                            <div>Luz ‚Üî Estudantes (Mogi das Cruzes)</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="cptm" data-line="Linha 12 ‚Äì Safira">
                        <div class="line-color" style="background-color: #1B48A0;"></div>
                        <div>
                            <strong>Linha 12 ‚Äì Safira</strong>
                            <div>Br√°s ‚Üî Calmon Viana</div>
                        </div>
                    </div>
                    <div class="option-item line-item" data-type="cptm" data-line="Linha 13 ‚Äì Jade">
                        <div class="line-color" style="background-color: #00A88F;"></div>
                        <div>
                            <strong>Linha 13 ‚Äì Jade</strong>
                            <div>Engenheiro Goulart ‚Üî Aeroporto Guarulhos</div>
                        </div>
                    </div>
                </div>
                
                <!-- Container para esta√ß√µes da CPTM -->
                <div id="cptmStations" class="options-container"></div>
                
                <!-- Formul√°rio de endere√ßo -->
                <div id="addressForm" class="address-form" style="display: none;">
                    <div class="form-row">
                        <div class="input-group">
                            <label for="cep">CEP</label>
                            <input type="text" id="cep" maxlength="9" placeholder="00000-000">
                            <small>Digite o CEP para preencher automaticamente</small>
                        </div>
                        <div class="input-group">
                            <label for="numero">N√∫mero</label>
                            <input type="text" id="numero" placeholder="N√∫mero do endere√ßo">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="input-group">
                            <label for="rua">Rua</label>
                            <input type="text" id="rua" placeholder="Rua" readonly>
                        </div>
                        <div class="input-group">
                            <label for="bairro">Bairro</label>
                            <input type="text" id="bairro" placeholder="Bairro" readonly>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="input-group">
                            <label for="cidade">Munic√≠pio</label>
                            <input type="text" id="cidade" placeholder="Cidade" readonly>
                        </div>
                        <div class="input-group">
                            <label for="estado">Estado</label>
                            <input type="text" id="estado" placeholder="Estado" readonly>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="complemento">Complemento (opcional)</label>
                        <input type="text" id="complemento" placeholder="Apartamento, bloco, etc.">
                    </div>
                </div>
                
                <!-- Informa√ß√µes de localiza√ß√£o da esta√ß√£o -->
                <div id="locationInfo" class="location-info">
                    <h3><i class="fas fa-map-pin"></i> Localiza√ß√£o da Esta√ß√£o</h3>
                    <div class="location-details">
                        <div class="location-item">
                            <div class="location-label">Latitude</div>
                            <div id="stationLat">-</div>
                        </div>
                        <div class="location-item">
                            <div class="location-label">Longitude</div>
                            <div id="stationLng">-</div>
                        </div>
                        <div class="location-item">
                            <div class="location-label">Endere√ßo</div>
                            <div id="stationAddress">-</div>
                        </div>
                        <div class="location-item">
                            <div class="location-label">Dist√¢ncia Atual</div>
                            <div id="realDistance">-</div>
                        </div>
                    </div>
                    
                    <div class="distance-indicator">
                        <div class="distance-progress" id="distanceProgress"></div>
                        <div class="distance-marker distance-marker-200" title="200 metros"></div>
                        <div class="distance-marker distance-marker-100" title="100 metros"></div>
                        <div class="distance-marker distance-marker-50" title="50 metros"></div>
                    </div>
                    <div class="distance-labels">
                        <span>1000m</span>
                        <span>500m</span>
                        <span>200m</span>
                        <span>100m</span>
                        <span>50m</span>
                        <span>0m</span>
                    </div>
                    
                    <div class="map-container">
                        <div class="map-placeholder" id="mapPlaceholder">
                            <i class="fas fa-map"></i>
                            <p>Mapa da localiza√ß√£o da esta√ß√£o</p>
                            <p id="mapCoordinates">Coordenadas: -</p>
                        </div>
                    </div>
                    
                    <button class="auto-monitoring-btn" id="startMonitoring">
                        <i class="fas fa-satellite-dish"></i> Iniciar Monitoramento em Tempo Real
                    </button>
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn confirm-btn" id="confirmBtn">
                        <i class="fas fa-check-circle"></i> Confirmar Sele√ß√£o
                    </button>
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title"><i class="fas fa-info-circle"></i> Status do Sistema</h2>
                
                <div class="status-container">
                    <div class="status-item">
                        <div>Tipo de Transporte</div>
                        <div class="status-value" id="transportType">Nenhum</div>
                    </div>
                    <div class="status-item">
                        <div>Esta√ß√£o/Destino</div>
                        <div class="status-value" id="selectedStation">Nenhum</div>
                    </div>
                    <div class="status-item">
                        <div>Dist√¢ncia Atual</div>
                        <div class="status-value" id="currentDistance">-</div>
                    </div>
                </div>
                
                <div class="status-container">
                    <div class="status-item">
                        <div>Localiza√ß√£o do Usu√°rio</div>
                        <div class="status-value" id="currentLocation">Obtendo...</div>
                    </div>
                    <div class="status-item">
                        <div>Linha Selecionada</div>
                        <div class="status-value" id="selectedLine">Nenhuma</div>
                    </div>
                </div>
                
                <div class="status-container">
                    <div class="status-item">
                        <div>Status do Alarme</div>
                        <div class="status-value" id="alarmDistanceStatus">Desativado</div>
                    </div>
                    <div class="status-item">
                        <div>Pr√≥ximo Alerta</div>
                        <div class="status-value" id="nextAlertAt">200 metros</div>
                    </div>
                </div>
                
                <h2 class="section-title"><i class="fas fa-bell"></i> Configura√ß√£o do Alarme</h2>
                
                <div class="alarm-controls">
                    <button class="alarm-btn alarm-on" id="enableAlarm">
                        <i class="fas fa-bell"></i> Ativar Alarme (200m)
                    </button>
                    
                    <button class="alarm-btn alarm-off" id="disableAlarm">
                        <i class="fas fa-bell-slash"></i> Desativar Alarme
                    </button>
                    
                    <select id="alarmSound">
                        <option value="alarm1">Alarme Cl√°ssico</option>
                        <option value="alarm2">Alarme Moderno</option>
                        <option value="alarm3">Alarme Mel√≥dico</option>
                        <option value="alarm4">Alerta de Trem</option>
                    </select>
                </div>
                
                <div class="alarm-status alarm-inactive" id="alarmStatus">
                    <i class="fas fa-bell-slash"></i> Alarme Desativado - Ser√° acionado a 200m
                </div>
                
                <div class="instructions-box">
                    <h4><i class="fas fa-exclamation-triangle"></i> Instru√ß√µes:</h4>
                    <p>1. Selecione uma esta√ß√£o ou endere√ßo</p>
                    <p>2. Ative o alarme</p>
                    <p>3. O sistema monitorar√° sua localiza√ß√£o em tempo real</p>
                    <p>4. <strong class="distance-warning">Alarme acionado automaticamente a 200 metros</strong></p>
                </div>
            </div>
            
            <div class="section alarm-section">
                <h2 class="section-title"><i class="fas fa-map"></i> Simula√ß√£o de Viagem</h2>
                <p>Clique no bot√£o abaixo para simular uma viagem e testar o sistema de alerta de 200m</p>
                
                <div class="alarm-controls simulation-controls">
                    <button class="alarm-btn alarm-on" id="simulateTrip">
                        <i class="fas fa-play-circle"></i> Simular Aproxima√ß√£o
                    </button>
                    
                    <button class="alarm-btn alarm-off" id="stopSimulation">
                        <i class="fas fa-stop-circle"></i> Parar Simula√ß√£o
                    </button>
                </div>
                
                <select id="simulationSpeed">
                    <option value="1000">Lenta (1x)</option>
                    <option value="500">Normal (2x)</option>
                    <option value="250">R√°pida (4x)</option>
                    <option value="100">Muito R√°pida (10x)</option>
                </select>
                
                <div id="simulationStatus" style="margin-top: 15px; font-style: italic; font-size: 0.9rem;">
                    Clique em "Simular Aproxima√ß√£o" para testar o alerta de 200m
                </div>
            </div>
        </div>
        
        <footer>
            <p>Sistema de Transporte Inteligente &copy; 2023 - Desenvolvido para alertas de proximidade</p>
            <p>Metr√¥ SP e CPTM - Alerta autom√°tico a 200 metros do destino</p>
        </footer>
    </div>
    
    <!-- Notifica√ß√£o de alerta -->
    <div class="notification" id="notification">
        <button class="notification-close" id="closeNotification">&times;</button>
        <h3><i class="fas fa-exclamation-triangle"></i> Alerta de Proximidade!</h3>
        <p id="notificationMessage">Voc√™ est√° se aproximando do seu destino!</p>
        <p><strong>Dist√¢ncia atual:</strong> <span id="notificationDistance">200 metros</span></p>
        <p><strong>Destino:</strong> <span id="notificationDestination">-</span></p>
        <p><small>Alarme acionado automaticamente</small></p>
    </div>
    
    <!-- Elementos de √°udio para os alarmes -->
    <audio id="alarm1" class="alarm-sound" loop>
        <source src="https://assets.mixkit.co/active_storage/sfx/286/286-preview.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="alarm2" class="alarm-sound" loop>
        <source src="https://assets.mixkit.co/active_storage/sfx/250/250-preview.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="alarm3" class="alarm-sound" loop>
        <source src="https://assets.mixkit.co/active_storage/sfx/255/255-preview.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="alarm4" class="alarm-sound" loop>
        <source src="https://assets.mixkit.co/active_storage/sfx/269/269-preview.mp3" type="audio/mpeg">
    </audio>
    
    <script>
        // Elementos do DOM
        const cptmBtn = document.getElementById('cptmBtn');
        const metroBtn = document.getElementById('metroBtn');
        const addressBtn = document.getElementById('addressBtn');
        const cptmLines = document.getElementById('cptmLines');
        const cptmStations = document.getElementById('cptmStations');
        const metroLines = document.getElementById('metroLines');
        const metroStations = document.getElementById('metroStations');
        const addressForm = document.getElementById('addressForm');
        const confirmBtn = document.getElementById('confirmBtn');
        const enableAlarmBtn = document.getElementById('enableAlarm');
        const disableAlarmBtn = document.getElementById('disableAlarm');
        const alarmStatus = document.getElementById('alarmStatus');
        const alarmSoundSelect = document.getElementById('alarmSound');
        const simulateTripBtn = document.getElementById('simulateTrip');
        const stopSimulationBtn = document.getElementById('stopSimulation');
        const notification = document.getElementById('notification');
        const closeNotificationBtn = document.getElementById('closeNotification');
        const notificationMessage = document.getElementById('notificationMessage');
        const notificationDistance = document.getElementById('notificationDistance');
        const notificationDestination = document.getElementById('notificationDestination');
        const selectionPath = document.getElementById('selectionPath');
        const locationInfo = document.getElementById('locationInfo');
        const stationLat = document.getElementById('stationLat');
        const stationLng = document.getElementById('stationLng');
        const stationAddress = document.getElementById('stationAddress');
        const realDistance = document.getElementById('realDistance');
        const distanceProgress = document.getElementById('distanceProgress');
        const mapPlaceholder = document.getElementById('mapPlaceholder');
        const mapCoordinates = document.getElementById('mapCoordinates');
        const startMonitoringBtn = document.getElementById('startMonitoring');
        const simulationSpeed = document.getElementById('simulationSpeed');
        const installPwaBtn = document.getElementById('installPWA');
        const pwaInstructions = document.getElementById('pwaInstructions');
        
        // Elementos de status
        const transportTypeEl = document.getElementById('transportType');
        const selectedStationEl = document.getElementById('selectedStation');
        const selectedLineEl = document.getElementById('selectedLine');
        const currentDistanceEl = document.getElementById('currentDistance');
        const currentLocationEl = document.getElementById('currentLocation');
        const simulationStatusEl = document.getElementById('simulationStatus');
        const alarmDistanceStatus = document.getElementById('alarmDistanceStatus');
        const nextAlertAt = document.getElementById('nextAlertAt');
        
        // Elementos do formul√°rio de endere√ßo
        const cepInput = document.getElementById('cep');
        const ruaInput = document.getElementById('rua');
        const bairroInput = document.getElementById('bairro');
        const cidadeInput = document.getElementById('cidade');
        const estadoInput = document.getElementById('estado');
        const numeroInput = document.getElementById('numero');
        const complementoInput = document.getElementById('complemento');
        
        // Dados COMPLETOS das esta√ß√µes por linha com coordenadas reais aproximadas em S√£o Paulo
        const metroStationsData = {
            "Linha 1 ‚Äì Azul": [
                {name: "Jabaquara", lat: -23.648, lng: -46.654, address: "Av. Engenheiro Armando de Arruda Pereira, Jabaquara"},
                {name: "Concei√ß√£o", lat: -23.641, lng: -46.652, address: "Av. Engenheiro Armando de Arruda Pereira, Jabaquara"},
                {name: "S√£o Judas", lat: -23.624, lng: -46.651, address: "Av. Jabaquara, Sa√∫de"},
                {name: "Sa√∫de", lat: -23.617, lng: -46.650, address: "Av. Jabaquara, Sa√∫de"},
                {name: "Pra√ßa da √Årvore", lat: -23.611, lng: -46.647, address: "Rua Loefgren, Vila Mariana"},
                {name: "Santa Cruz", lat: -23.605, lng: -46.646, address: "Rua Domingos de Morais, Vila Mariana"},
                {name: "Vila Mariana", lat: -23.598, lng: -46.644, address: "Av. Brigadeiro Lu√≠s Ant√¥nio, Vila Mariana"},
                {name: "Ana Rosa", lat: -23.592, lng: -46.642, address: "Av. Vergueiro, Vila Mariana"},
                {name: "Para√≠so", lat: -23.585, lng: -46.641, address: "Rua Vergueiro, Para√≠so"},
                {name: "Vergueiro", lat: -23.579, lng: -46.639, address: "Av. Vergueiro, Liberdade"},
                {name: "S√£o Joaquim", lat: -23.572, lng: -46.637, address: "Rua S√£o Joaquim, Liberdade"},
                {name: "S√©", lat: -23.5505, lng: -46.6333, address: "Pra√ßa da S√©, Centro"},
                {name: "Luz", lat: -23.535, lng: -46.635, address: "Pra√ßa da Luz, Bom Retiro"},
                {name: "Tiradentes", lat: -23.531, lng: -46.636, address: "Av. Tiradentes, Bom Retiro"},
                {name: "Arm√™nia", lat: -23.529, lng: -46.637, address: "Av. Cruzeiro do Sul, Bom Retiro"},
                {name: "Portuguesa-Tiet√™", lat: -23.521, lng: -46.639, address: "Av. Cruzeiro do Sul, Bom Retiro"},
                {name: "Carandiru", lat: -23.513, lng: -46.641, address: "Av. Cruzeiro do Sul, Carandiru"},
                {name: "Santana", lat: -23.505, lng: -46.642, address: "Av. Cruzeiro do Sul, Santana"},
                {name: "Jardim S√£o Paulo", lat: -23.497, lng: -46.644, address: "Av. Le√¥ncio de Magalh√£es, Jardim S√£o Paulo"},
                {name: "Parada Inglesa", lat: -23.489, lng: -46.645, address: "Av. Dr. Antonio Maria Laet, Parada Inglesa"},
                {name: "Tucuruvi", lat: -23.480, lng: -46.647, address: "Av. Dr. Antonio Maria Laet, Tucuruvi"}
            ],
            "Linha 2 ‚Äì Verde": [
                {name: "Vila Prudente", lat: -23.625, lng: -46.605, address: "Av. do Estado, Vila Prudente"},
                {name: "Tamanduate√≠", lat: -23.618, lng: -46.610, address: "Av. do Estado, Ipiranga"},
                {name: "Sacom√£", lat: -23.611, lng: -46.615, address: "Av. do Estado, Sacom√£"},
                {name: "Alto do Ipiranga", lat: -23.604, lng: -46.620, address: "Av. do Estado, Ipiranga"},
                {name: "Santos-Imigrantes", lat: -23.597, lng: -46.625, address: "Av. dos Imigrantes, Vila Mariana"},
                {name: "Ch√°cara Klabin", lat: -23.590, lng: -46.630, address: "Rua Doutor C√©sar, Vila Mariana"},
                {name: "Ana Rosa", lat: -23.592, lng: -46.642, address: "Av. Vergueiro, Vila Mariana"},
                {name: "Para√≠so", lat: -23.585, lng: -46.641, address: "Rua Vergueiro, Para√≠so"},
                {name: "Brigadeiro", lat: -23.577, lng: -46.650, address: "Av. Brigadeiro Lu√≠s Ant√¥nio, Bela Vista"},
                {name: "Trianon-Masp", lat: -23.570, lng: -46.655, address: "Av. Paulista, Bela Vista"},
                {name: "Consola√ß√£o", lat: -23.562, lng: -46.658, address: "Rua da Consola√ß√£o, Consola√ß√£o"},
                {name: "Cl√≠nicas", lat: -23.555, lng: -46.670, address: "Av. Dr. En√©as Carvalho de Aguiar, Cerqueira C√©sar"},
                {name: "Sumar√©", lat: -23.556, lng: -46.677, address: "Rua Doutor C√©sar, Sumar√©"},
                {name: "Vila Madalena", lat: -23.547, lng: -46.694, address: "Pra√ßa Doutor Jo√£o Mendes, Vila Madalena"}
            ],
            "Linha 3 ‚Äì Vermelha": [
                {name: "Corinthians-Itaquera", lat: -23.543, lng: -46.472, address: "Av. Jos√© Pinheiro Borges, Itaquera"},
                {name: "Artur Alvim", lat: -23.541, lng: -46.478, address: "Rua Alto Artur Alvim, Artur Alvim"},
                {name: "Patriarca", lat: -23.539, lng: -46.483, address: "Rua da Mooca, Patriarca"},
                {name: "Guilhermina-Esperan√ßa", lat: -23.537, lng: -46.489, address: "Rua Dr. Assis Guimar√£es, Vila Guilhermina"},
                {name: "Vila Matilde", lat: -23.535, lng: -46.494, address: "Rua Cotox√≥, Vila Matilde"},
                {name: "Penha", lat: -23.533, lng: -46.500, address: "Rua Padre Francisco das Chagas, Penha"},
                {name: "Carr√£o", lat: -23.531, lng: -46.505, address: "Rua Tuiuti, Carr√£o"},
                {name: "Tatuap√©", lat: -23.540, lng: -46.576, address: "Rua Tuiuti, Tatuap√©"},
                {name: "Bel√©m", lat: -23.538, lng: -46.582, address: "Av. Celso Garcia, Bel√©m"},
                {name: "Bresser-Mooca", lat: -23.545, lng: -46.615, address: "Rua dos Trilhos, Mooca"},
                {name: "Br√°s", lat: -23.545, lng: -46.615, address: "Av. Rangel Pestana, Br√°s"},
                {name: "Pedro II", lat: -23.547, lng: -46.619, address: "Rua Alfredo Maia, Br√°s"},
                {name: "S√©", lat: -23.5505, lng: -46.6333, address: "Pra√ßa da S√©, Centro"},
                {name: "Rep√∫blica", lat: -23.546, lng: -46.643, address: "Pra√ßa da Rep√∫blica, Centro"},
                {name: "Anhangaba√∫", lat: -23.548, lng: -46.640, address: "Viaduto do Ch√°, Centro"},
                {name: "Santa Cec√≠lia", lat: -23.535, lng: -46.650, address: "Rua Santa Cec√≠lia, Santa Cec√≠lia"},
                {name: "Marechal Deodoro", lat: -23.532, lng: -46.655, address: "Rua Santa Cec√≠lia, Santa Cec√≠lia"},
                {name: "Palmeiras-Barra Funda", lat: -23.526, lng: -46.667, address: "Av. Marqu√™s de S√£o Vicente, Barra Funda"}
            ],
            "Linha 4 ‚Äì Amarela": [
                {name: "Luz", lat: -23.535, lng: -46.635, address: "Pra√ßa da Luz, Bom Retiro"},
                {name: "Rep√∫blica", lat: -23.546, lng: -46.643, address: "Pra√ßa da Rep√∫blica, Centro"},
                {name: "Higien√≥polis-Mackenzie", lat: -23.548, lng: -46.650, address: "Rua da Consola√ß√£o, Consola√ß√£o"},
                {name: "Paulista", lat: -23.561, lng: -46.655, address: "Av. Paulista, Bela Vista"},
                {name: "Fradique Coutinho", lat: -23.568, lng: -46.682, address: "Rua Fradique Coutinho, Pinheiros"},
                {name: "Faria Lima", lat: -23.569, lng: -46.692, address: "Av. Brigadeiro Faria Lima, Pinheiros"},
                {name: "Pinheiros", lat: -23.568, lng: -46.702, address: "Av. das Na√ß√µes Unidas, Pinheiros"},
                {name: "Butant√£", lat: -23.572, lng: -46.710, address: "Av. Vital Brasil, Butant√£"},
                {name: "S√£o Paulo-Morumbi", lat: -23.583, lng: -46.720, address: "Av. Jorge Jo√£o Saad, Morumbi"},
                {name: "Vila S√¥nia", lat: -23.592, lng: -46.730, address: "Rua Aspicuelta, Vila S√¥nia"}
            ],
            "Linha 5 ‚Äì Lil√°s": [
                {name: "Cap√£o Redondo", lat: -23.668, lng: -46.768, address: "Av. Carlos Caldeira Filho, Cap√£o Redondo"},
                {name: "Campo Limpo", lat: -23.652, lng: -46.758, address: "Av. Carlos Caldeira Filho, Campo Limpo"},
                {name: "Vila das Belezas", lat: -23.636, lng: -46.748, address: "Av. Professor Jos√© Maria de Azevedo, Vila Andrade"},
                {name: "Giovanni Gronchi", lat: -23.628, lng: -46.738, address: "Av. Giovanni Gronchi, Vila Andrade"},
                {name: "Santo Amaro", lat: -23.650, lng: -46.722, address: "Av. Santo Amaro, Santo Amaro"},
                {name: "Largo Treze", lat: -23.647, lng: -46.714, address: "Rua Largo Treze de Maio, Santo Amaro"},
                {name: "Adolfo Pinheiro", lat: -23.644, lng: -46.706, address: "Rua Adolfo Pinheiro, Santo Amaro"},
                {name: "Alto da Boa Vista", lat: -23.641, lng: -46.698, address: "Rua Professor Daijiro Matsuda, Alto da Boa Vista"},
                {name: "Borba Gato", lat: -23.638, lng: -46.690, address: "Av. Santo Amaro, Vila Ol√≠mpia"},
                {name: "Brooklin", lat: -23.635, lng: -46.682, address: "Rua Bar√£o do Triunfo, Brooklin"},
                {name: "Campo Belo", lat: -23.632, lng: -46.674, address: "Rua Jurandir, Campo Belo"},
                {name: "Eucaliptos", lat: -23.629, lng: -46.666, address: "Rua Eucaliptos, Moema"},
                {name: "Moema", lat: -23.606, lng: -46.664, address: "Av. Moema, Moema"},
                {name: "AACD-Servidor", lat: -23.599, lng: -46.662, address: "Av. Indian√≥polis, Moema"},
                {name: "Hospital S√£o Paulo", lat: -23.592, lng: -46.660, address: "Rua Napole√£o de Barros, Vila Clementino"},
                {name: "Santa Cruz", lat: -23.605, lng: -46.646, address: "Rua Domingos de Morais, Vila Mariana"},
                {name: "Ch√°cara Klabin", lat: -23.590, lng: -46.630, address: "Rua Doutor C√©sar, Vila Mariana"}
            ],
            "Linha 15 ‚Äì Prata": [
                {name: "Vila Prudente", lat: -23.625, lng: -46.605, address: "Av. do Estado, Vila Prudente"},
                {name: "Orat√≥rio", lat: -23.632, lng: -46.600, address: "Rua do Orat√≥rio, Sapopemba"},
                {name: "S√£o Lucas", lat: -23.639, lng: -46.595, address: "Av. Sapopemba, Sapopemba"},
                {name: "Camilo Haddad", lat: -23.646, lng: -46.590, address: "Av. Sapopemba, Sapopemba"},
                {name: "Vila Tolst√≥i", lat: -23.653, lng: -46.585, address: "Rua Lev Tolst√≥i, Sapopemba"},
                {name: "Vila Uni√£o", lat: -23.660, lng: -46.580, address: "Rua Nelson Fernandes, S√£o Mateus"},
                {name: "Jardim Planalto", lat: -23.667, lng: -46.575, address: "Rua Alasca, S√£o Mateus"},
                {name: "Sapopemba", lat: -23.674, lng: -46.570, address: "Rua Sapopemba, S√£o Mateus"},
                {name: "Fazenda da Juta", lat: -23.681, lng: -46.565, address: "Rua das Cam√©lias, S√£o Mateus"},
                {name: "S√£o Mateus", lat: -23.688, lng: -46.560, address: "Av. Sapopemba, S√£o Mateus"},
                {name: "Jardim Colonial", lat: -23.695, lng: -46.555, address: "Av. Ragueb Chohfi, S√£o Mateus"}
            ]
        };
        
        const cptmStationsData = {
            "Linha 7 ‚Äì Rubi": [
                {name: "Br√°s", lat: -23.545, lng: -46.615, address: "Av. Rangel Pestana, Br√°s"},
                {name: "Luz", lat: -23.535, lng: -46.635, address: "Pra√ßa da Luz, Bom Retiro"},
                {name: "Barra Funda", lat: -23.526, lng: -46.667, address: "Av. Marqu√™s de S√£o Vicente, Barra Funda"},
                {name: "√Ågua Branca", lat: -23.532, lng: -46.680, address: "Rua General Ol√≠mpio da Silveira, √Ågua Branca"},
                {name: "Lapa", lat: -23.522, lng: -46.707, address: "Rua Guaicurus, Lapa"},
                {name: "Piqueri", lat: -23.518, lng: -46.714, address: "Rua Piqueri, Lapa"},
                {name: "Pirituba", lat: -23.515, lng: -46.721, address: "Rua dos Tr√™s Irm√£os, Pirituba"},
                {name: "Vila Clarice", lat: -23.512, lng: -46.728, address: "Rua Cinira Pol√¥nio, Pirituba"},
                {name: "Jaragu√°", lat: -23.509, lng: -46.735, address: "Rua Canuto Saraiva, Jaragu√°"},
                {name: "Perus", lat: -23.506, lng: -46.742, address: "Rua Galileu Galilei, Perus"},
                {name: "Caieiras", lat: -23.488, lng: -46.760, address: "Av. Ant√¥nio de Almeida, Caieiras"},
                {name: "Franco da Rocha", lat: -23.480, lng: -46.768, address: "Av. Dr. Luiz Ant√¥nio de Souza, Franco da Rocha"},
                {name: "Baltazar Fid√©lis", lat: -23.472, lng: -46.776, address: "Av. Dr. Luiz Ant√¥nio de Souza, Franco da Rocha"},
                {name: "Francisco Morato", lat: -23.464, lng: -46.784, address: "Av. dos Expedicion√°rios, Francisco Morato"},
                {name: "Botujuru", lat: -23.456, lng: -46.792, address: "Rua Ant√¥nio Alves, Campo Limpo Paulista"},
                {name: "Campo Limpo Paulista", lat: -23.448, lng: -46.800, address: "Rua Jos√© Bonif√°cio, Campo Limpo Paulista"},
                {name: "V√°rzea Paulista", lat: -23.440, lng: -46.808, address: "Av. Fern√£o Dias, V√°rzea Paulista"},
                {name: "Jundia√≠", lat: -23.432, lng: -46.816, address: "Av. Uni√£o dos Ferrovi√°rios, Jundia√≠"}
            ],
            "Linha 8 ‚Äì Diamante": [
                {name: "J√∫lio Prestes", lat: -23.534, lng: -46.641, address: "Pra√ßa J√∫lio Prestes, Campos El√≠seos"},
                {name: "Palmeiras-Barra Funda", lat: -23.526, lng: -46.667, address: "Av. Marqu√™s de S√£o Vicente, Barra Funda"},
                {name: "Lapa", lat: -23.522, lng: -46.707, address: "Rua Guaicurus, Lapa"},
                {name: "Domingos de Moraes", lat: -23.530, lng: -46.715, address: "Rua Domingos de Moraes, Vila Leopoldina"},
                {name: "Imperatriz Leopoldina", lat: -23.538, lng: -46.723, address: "Rua Imperatriz Leopoldina, Vila Leopoldina"},
                {name: "Presidente Altino", lat: -23.540, lng: -46.738, address: "Av. dos Autonomistas, Osasco"},
                {name: "Osasco", lat: -23.545, lng: -46.750, address: "Av. dos Autonomistas, Osasco"},
                {name: "Comandante Sampaio", lat: -23.550, lng: -46.762, address: "Av. dos Autonomistas, Osasco"},
                {name: "Quita√∫na", lat: -23.555, lng: -46.774, address: "Av. dos Autonomistas, Osasco"},
                {name: "General Miguel Costa", lat: -23.560, lng: -46.786, address: "Av. dos Autonomistas, Carapicu√≠ba"},
                {name: "Carapicu√≠ba", lat: -23.565, lng: -46.798, address: "Av. Inoc√™ncio Ser√°fico, Carapicu√≠ba"},
                {name: "Santa Terezinha", lat: -23.570, lng: -46.810, address: "Rua Antonio Pires, Carapicu√≠ba"},
                {name: "Ant√¥nio Jo√£o", lat: -23.575, lng: -46.822, address: "Rua Ant√¥nio Jo√£o, Barueri"},
                {name: "Barueri", lat: -23.580, lng: -46.834, address: "Av. Ibirapuera, Barueri"},
                {name: "Jardim Belval", lat: -23.585, lng: -46.846, address: "Rua Doutor Ces√°rio Motta J√∫nior, Barueri"},
                {name: "Jandira", lat: -23.590, lng: -46.858, address: "Rua Jos√© Benedetti, Jandira"},
                {name: "Sagrado Cora√ß√£o", lat: -23.595, lng: -46.870, address: "Rua Santa Cruz, Jandira"},
                {name: "Engenheiro Cardoso", lat: -23.600, lng: -46.882, address: "Av. Engenheiro Cardoso, Itapevi"},
                {name: "Itapevi", lat: -23.605, lng: -46.894, address: "Av. Presidente Vargas, Itapevi"}
            ],
            "Linha 9 ‚Äì Esmeralda": [
                {name: "Osasco", lat: -23.545, lng: -46.750, address: "Av. dos Autonomistas, Osasco"},
                {name: "Presidente Altino", lat: -23.540, lng: -46.738, address: "Av. dos Autonomistas, Osasco"},
                {name: "Ceasa", lat: -23.535, lng: -46.726, address: "Av. Dr. Gast√£o Vidigal, Jaguar√©"},
                {name: "Villa-Lobos-Jaguar√©", lat: -23.530, lng: -46.714, address: "Av. Professor Francisco Morato, Jaguar√©"},
                {name: "Cidade Universit√°ria", lat: -23.556, lng: -46.730, address: "Av. Professor Almeida Prado, Butant√£"},
                {name: "Pinheiros", lat: -23.568, lng: -46.702, address: "Av. das Na√ß√µes Unidas, Pinheiros"},
                {name: "Hebraica-Rebou√ßas", lat: -23.575, lng: -46.690, address: "Av. Rebou√ßas, Pinheiros"},
                {name: "Cidade Jardim", lat: -23.590, lng: -46.695, address: "Av. Cidade Jardim, Jardim Europa"},
                {name: "Vila Ol√≠mpia", lat: -23.595, lng: -46.685, address: "Rua Olimp√≠adas, Vila Ol√≠mpia"},
                {name: "Berrini", lat: -23.600, lng: -46.695, address: "Av. Engenheiro Lu√≠s Carlos Berrini, Brooklin"},
                {name: "Morumbi", lat: -23.605, lng: -46.705, address: "Av. Jorge Jo√£o Saad, Morumbi"},
                {name: "Granja Julieta", lat: -23.610, lng: -46.715, address: "Rua Groenl√¢ndia, Santo Amaro"},
                {name: "Santo Amaro", lat: -23.650, lng: -46.722, address: "Av. Santo Amaro, Santo Amaro"},
                {name: "Socorro", lat: -23.655, lng: -46.735, address: "Av. Interlagos, Socorro"},
                {name: "Jurubatuba", lat: -23.660, lng: -46.748, address: "Av. Interlagos, Socorro"},
                {name: "Aut√≥dromo", lat: -23.665, lng: -46.761, address: "Av. Interlagos, Interlagos"},
                {name: "Primavera-Interlagos", lat: -23.670, lng: -46.774, address: "Av. Interlagos, Interlagos"},
                {name: "Graja√∫", lat: -23.675, lng: -46.787, address: "Av. Dona Belmira Marin, Graja√∫"},
                {name: "Mendes-Vila Natal", lat: -23.680, lng: -46.800, address: "Av. Sadamu Inoue, Graja√∫"},
                {name: "Varginha", lat: -23.685, lng: -46.813, address: "Av. Varginha, Graja√∫"}
            ],
            "Linha 10 ‚Äì Turquesa": [
                {name: "Br√°s", lat: -23.545, lng: -46.615, address: "Av. Rangel Pestana, Br√°s"},
                {name: "Tamanduate√≠", lat: -23.618, lng: -46.610, address: "Av. do Estado, Ipiranga"},
                {name: "Ipiranga", lat: -23.585, lng: -46.610, address: "Av. do Estado, Ipiranga"},
                {name: "Mooca", lat: -23.550, lng: -46.600, address: "Rua da Mooca, Mooca"},
                {name: "S√£o Caetano", lat: -23.610, lng: -46.580, address: "Av. Goi√°s, S√£o Caetano do Sul"},
                {name: "Utinga", lat: -23.625, lng: -46.550, address: "Av. Goi√°s, Santo Andr√©"},
                {name: "Prefeito Saladino", lat: -23.640, lng: -46.530, address: "Av. Portugal, Santo Andr√©"},
                {name: "Capuava", lat: -23.655, lng: -46.520, address: "Av. Capuava, Santo Andr√©"},
                {name: "Mau√°", lat: -23.670, lng: -46.510, address: "Rua da Esta√ß√£o, Mau√°"},
                {name: "Guapituba", lat: -23.685, lng: -46.500, address: "Rua Francisco Rodrigues, Mau√°"},
                {name: "Ribeir√£o Pires", lat: -23.700, lng: -46.490, address: "Rua Coronel Oliveira Lima, Ribeir√£o Pires"},
                {name: "Rio Grande da Serra", lat: -23.745, lng: -46.400, address: "Rua da Esta√ß√£o, Rio Grande da Serra"}
            ],
            "Linha 11 ‚Äì Coral": [
                {name: "Luz", lat: -23.535, lng: -46.635, address: "Pra√ßa da Luz, Bom Retiro"},
                {name: "Br√°s", lat: -23.545, lng: -46.615, address: "Av. Rangel Pestana, Br√°s"},
                {name: "Tatuap√©", lat: -23.540, lng: -46.576, address: "Rua Tuiuti, Tatuap√©"},
                {name: "Corinthians-Itaquera", lat: -23.543, lng: -46.472, address: "Av. Jos√© Pinheiro Borges, Itaquera"},
                {name: "Dom Bosco", lat: -23.545, lng: -46.468, address: "Rua Padre Jo√£o √Ålvares, Itaquera"},
                {name: "Jos√© Bonif√°cio", lat: -23.547, lng: -46.464, address: "Rua Jos√© Bonif√°cio, Itaquera"},
                {name: "Guaianases", lat: -23.549, lng: -46.460, address: "Rua Ant√¥nio Carlos, Guaianases"},
                {name: "Esta√ß√£o Ferraz de Vasconcelos", lat: -23.551, lng: -46.456, address: "Rua da Esta√ß√£o, Ferraz de Vasconcelos"},
                {name: "Po√°", lat: -23.553, lng: -46.452, address: "Rua da Esta√ß√£o, Po√°"},
                {name: "Calmon Viana", lat: -23.555, lng: -46.448, address: "Av. Calmon Viana, Po√°"},
                {name: "Suzano", lat: -23.557, lng: -46.444, address: "Rua Prudente de Moraes, Suzano"},
                {name: "Jundiapeba", lat: -23.559, lng: -46.440, address: "Rua Jundiapeba, Mogi das Cruzes"},
                {name: "Br√°s Cubas", lat: -23.561, lng: -46.436, address: "Rua Br√°s Cubas, Mogi das Cruzes"},
                {name: "Mogi das Cruzes", lat: -23.563, lng: -46.432, address: "Rua Capit√£o Manoel Ferreira, Mogi das Cruzes"},
                {name: "Estudantes", lat: -23.565, lng: -46.428, address: "Av. C√≠vica, Mogi das Cruzes"}
            ],
            "Linha 12 ‚Äì Safira": [
                {name: "Br√°s", lat: -23.545, lng: -46.615, address: "Av. Rangel Pestana, Br√°s"},
                {name: "Tatuap√©", lat: -23.540, lng: -46.576, address: "Rua Tuiuti, Tatuap√©"},
                {name: "Engenheiro Goulart", lat: -23.545, lng: -46.540, address: "Rua Frederico Goulart, Engenheiro Goulart"},
                {name: "USP Leste", lat: -23.550, lng: -46.530, address: "Av. Arlindo Bettio, Cidade Tiradentes"},
                {name: "Comendador Ermelino", lat: -23.555, lng: -46.520, address: "Rua Comendador Ermelino, Ermelino Matarazzo"},
                {name: "S√£o Miguel Paulista", lat: -23.560, lng: -46.510, address: "Rua Dona Ana Flora, S√£o Miguel Paulista"},
                {name: "Jardim Helena-Vila Mara", lat: -23.565, lng: -46.500, address: "Rua M√°rio Lopes Le√£o, Itaim Paulista"},
                {name: "Itaim Paulista", lat: -23.570, lng: -46.490, address: "Av. Marechal Tito, Itaim Paulista"},
                {name: "Jardim Romano", lat: -23.575, lng: -46.480, address: "Rua Eduardo Carlos Pereira, Itaim Paulista"},
                {name: "Engenheiro Manoel Feio", lat: -23.580, lng: -46.470, address: "Rua Engenheiro Manoel Feio, Itaquaquecetuba"},
                {name: "Itaquaquecetuba", lat: -23.585, lng: -46.460, address: "Rua Jo√£o Fiuza, Itaquaquecetuba"},
                {name: "Aracar√©", lat: -23.590, lng: -46.450, address: "Rua Rio Negro, Itaquaquecetuba"},
                {name: "Calmon Viana", lat: -23.555, lng: -46.448, address: "Av. Calmon Viana, Po√°"}
            ],
            "Linha 13 ‚Äì Jade": [
                {name: "Engenheiro Goulart", lat: -23.545, lng: -46.540, address: "Rua Frederico Goulart, Engenheiro Goulart"},
                {name: "Tatuap√©", lat: -23.540, lng: -46.576, address: "Rua Tuiuti, Tatuap√©"},
                {name: "Br√°s", lat: -23.545, lng: -46.615, address: "Av. Rangel Pestana, Br√°s"},
                {name: "Luz", lat: -23.535, lng: -46.635, address: "Pra√ßa da Luz, Bom Retiro"},
                {name: "Guarulhos-Cecap", lat: -23.480, lng: -46.520, address: "Av. Santos Dumont, Guarulhos"},
                {name: "Aeroporto-Guarulhos", lat: -23.435, lng: -46.473, address: "Rod. H√©lio Smidt, Guarulhos"}
            ]
        };
        
        // Vari√°veis do sistema
        let selectedOption = null;
        let alarmEnabled = false;
        let simulationInterval = null;
        let monitoringInterval = null;
        let currentRealDistance = 1000; // Dist√¢ncia inicial em metros
        let userLocation = null;
        let stationLocation = null;
        let currentSelectionStep = 'none';
        let selectedLine = null;
        let isMonitoring = false;
        let deferredPrompt = null;
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            // Obter localiza√ß√£o do usu√°rio
            getUserLocation();
            
            // Configurar eventos dos bot√µes de transporte
            cptmBtn.addEventListener('click', () => showTransportLines('cptm'));
            metroBtn.addEventListener('click', () => showTransportLines('metro'));
            addressBtn.addEventListener('click', () => showOptions('address'));
            
            // Configurar bot√£o de confirma√ß√£o
            confirmBtn.addEventListener('click', confirmSelection);
            
            // Configurar alarme
            enableAlarmBtn.addEventListener('click', enableAlarm);
            disableAlarmBtn.addEventListener('click', disableAlarm);
            
            // Configurar simula√ß√£o
            simulateTripBtn.addEventListener('click', startSimulation);
            stopSimulationBtn.addEventListener('click', stopSimulation);
            
            // Configurar notifica√ß√£o
            closeNotificationBtn.addEventListener('click', () => {
                notification.style.display = 'none';
                stopAllAlarms();
            });
            
            // Configurar busca por CEP
            cepInput.addEventListener('input', formatCEP);
            cepInput.addEventListener('blur', fetchAddressByCEP);
            
            // Configurar bot√£o de monitoramento
            startMonitoringBtn.addEventListener('click', toggleMonitoring);
            
            // Configurar PWA
            setupPWA();
            
            // Configurar bot√£o de instala√ß√£o PWA
            installPwaBtn.addEventListener('click', showPWAInstructions);
            
            // Configurar sele√ß√£o autom√°tica ao clicar em endere√ßo
            addressBtn.addEventListener('click', function() {
                selectedOption = { type: 'endere√ßo', line: 'Endere√ßo Cadastrado', station: 'Meu Endere√ßo' };
                transportTypeEl.textContent = 'Endere√ßo';
                selectedLineEl.textContent = 'Endere√ßo Cadastrado';
                selectedStationEl.textContent = 'Aguardando cadastro';
            });
        });
        
        // Fun√ß√£o para configurar PWA
        function setupPWA() {
            // Verificar se o navegador suporta service workers
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('data:application/javascript;base64,KCgpID0+IHsKICAvLyBTZXJ2aWNlIHdvcmtlciBzaW1wbGVzIHBhcmEgUFdBIC0gYWx0ZXJhciBzZSBuZWNlc3NhcmlvCiAgc2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgKCkgPT4gewogICAgY29uc29sZS5sb2coJ1BXQSBpbnN0YWxsZWQnKTsKICB9KTsKfSkoKTs=').then(registration => {
                        console.log('Service Worker registrado com sucesso:', registration.scope);
                    }).catch(error => {
                        console.log('Falha ao registrar Service Worker:', error);
                    });
                });
            }
            
            // Detectar evento de instala√ß√£o PWA
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                installPwaBtn.style.display = 'block';
            });
            
            // Verificar se j√° est√° instalado
            window.addEventListener('appinstalled', () => {
                console.log('PWA instalado com sucesso!');
                installPwaBtn.style.display = 'none';
                pwaInstructions.style.display = 'none';
            });
            
            // Verificar modo standalone
            if (window.matchMedia('(display-mode: standalone)').matches) {
                console.log('App rodando em modo standalone');
                installPwaBtn.style.display = 'none';
            }
        }
        
        // Fun√ß√£o para mostrar instru√ß√µes de instala√ß√£o PWA
        function showPWAInstructions() {
            pwaInstructions.style.display = 'block';
            
            // Se houver prompt de instala√ß√£o, mostrar
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('Usu√°rio aceitou instala√ß√£o');
                        pwaInstructions.innerHTML = '<h4><i class="fas fa-check-circle"></i> Instala√ß√£o iniciada!</h4><p>Siga as instru√ß√µes do seu navegador para completar a instala√ß√£o.</p>';
                    } else {
                        console.log('Usu√°rio recusou instala√ß√£o');
                    }
                    deferredPrompt = null;
                });
            }
        }
        
        // Fun√ß√£o para mostrar linhas de transporte
        function showTransportLines(transportType) {
            // Esconder todos os containers
            cptmLines.style.display = 'none';
            cptmStations.style.display = 'none';
            metroLines.style.display = 'none';
            metroStations.style.display = 'none';
            addressForm.style.display = 'none';
            locationInfo.style.display = 'none';
            
            // Limpar sele√ß√£o
            document.querySelectorAll('.option-item').forEach(el => el.classList.remove('selected'));
            selectedOption = null;
            selectedLine = null;
            stationLocation = null;
            
            // Atualizar caminho de sele√ß√£o
            selectionPath.style.display = 'block';
            
            if (transportType === 'cptm') {
                currentSelectionStep = 'cptm-lines';
                cptmLines.style.display = 'block';
                selectionPath.innerHTML = '<i class="fas fa-train"></i> CPTM > Selecione uma linha';
                
                // Configurar sele√ß√£o de linhas da CPTM
                document.querySelectorAll('#cptmLines .option-item').forEach(item => {
                    item.addEventListener('click', function() {
                        document.querySelectorAll('#cptmLines .option-item').forEach(el => el.classList.remove('selected'));
                        this.classList.add('selected');
                        selectedLine = this.getAttribute('data-line');
                        selectedLineEl.textContent = selectedLine;
                        showStationsForLine('cptm', selectedLine);
                    });
                });
                
            } else if (transportType === 'metro') {
                currentSelectionStep = 'metro-lines';
                metroLines.style.display = 'block';
                selectionPath.innerHTML = '<i class="fas fa-subway"></i> Metr√¥ > Selecione uma linha';
                
                // Configurar sele√ß√£o de linhas do Metr√¥
                document.querySelectorAll('#metroLines .option-item').forEach(item => {
                    item.addEventListener('click', function() {
                        document.querySelectorAll('#metroLines .option-item').forEach(el => el.classList.remove('selected'));
                        this.classList.add('selected');
                        selectedLine = this.getAttribute('data-line');
                        selectedLineEl.textContent = selectedLine;
                        showStationsForLine('metro', selectedLine);
                    });
                });
            }
            
            // Atualizar status
            transportTypeEl.textContent = transportType === 'cptm' ? 'CPTM' : 'Metr√¥';
            selectedStationEl.textContent = 'Nenhuma';
        }
        
        // Fun√ß√£o para mostrar esta√ß√µes de uma linha
        function showStationsForLine(transportType, line) {
            // Esconder containers de linhas
            if (transportType === 'cptm') {
                cptmLines.style.display = 'none';
                cptmStations.style.display = 'block';
                currentSelectionStep = 'cptm-stations';
                selectionPath.innerHTML = `<i class="fas fa-train"></i> CPTM > ${line} > Selecione uma esta√ß√£o`;
                
                // Limpar esta√ß√µes anteriores
                cptmStations.innerHTML = `
                    <button class="back-btn" id="backToCptmLines">
                        <i class="fas fa-arrow-left"></i> Voltar para linhas
                    </button>
                    <h3>${line}</h3>
                `;
                
                // Adicionar bot√£o voltar
                document.getElementById('backToCptmLines').addEventListener('click', () => {
                    showTransportLines('cptm');
                });
                
                // Adicionar esta√ß√µes
                const stations = cptmStationsData[line] || [];
                stations.forEach(station => {
                    const stationItem = document.createElement('div');
                    stationItem.className = 'option-item station-item';
                    stationItem.innerHTML = `
                        <div><strong>${station.name}</strong></div>
                        <div style="font-size: 0.8rem; opacity: 0.8;">${station.address}</div>
                    `;
                    stationItem.setAttribute('data-type', 'cptm');
                    stationItem.setAttribute('data-line', line);
                    stationItem.setAttribute('data-station', station.name);
                    stationItem.setAttribute('data-lat', station.lat);
                    stationItem.setAttribute('data-lng', station.lng);
                    stationItem.setAttribute('data-address', station.address);
                    
                    stationItem.addEventListener('click', function() {
                        document.querySelectorAll('#cptmStations .option-item').forEach(el => el.classList.remove('selected'));
                        this.classList.add('selected');
                        selectStation(transportType, line, station);
                    });
                    
                    cptmStations.appendChild(stationItem);
                });
                
            } else if (transportType === 'metro') {
                metroLines.style.display = 'none';
                metroStations.style.display = 'block';
                currentSelectionStep = 'metro-stations';
                selectionPath.innerHTML = `<i class="fas fa-subway"></i> Metr√¥ > ${line} > Selecione uma esta√ß√£o`;
                
                // Limpar esta√ß√µes anteriores
                metroStations.innerHTML = `
                    <button class="back-btn" id="backToMetroLines">
                        <i class="fas fa-arrow-left"></i> Voltar para linhas
                    </button>
                    <h3>${line}</h3>
                `;
                
                // Adicionar bot√£o voltar
                document.getElementById('backToMetroLines').addEventListener('click', () => {
                    showTransportLines('metro');
                });
                
                // Adicionar esta√ß√µes
                const stations = metroStationsData[line] || [];
                stations.forEach(station => {
                    const stationItem = document.createElement('div');
                    stationItem.className = 'option-item station-item';
                    stationItem.innerHTML = `
                        <div><strong>${station.name}</strong></div>
                        <div style="font-size: 0.8rem; opacity: 0.8;">${station.address}</div>
                    `;
                    stationItem.setAttribute('data-type', 'metro');
                    stationItem.setAttribute('data-line', line);
                    stationItem.setAttribute('data-station', station.name);
                    stationItem.setAttribute('data-lat', station.lat);
                    stationItem.setAttribute('data-lng', station.lng);
                    stationItem.setAttribute('data-address', station.address);
                    
                    stationItem.addEventListener('click', function() {
                        document.querySelectorAll('#metroStations .option-item').forEach(el => el.classList.remove('selected'));
                        this.classList.add('selected');
                        selectStation(transportType, line, station);
                    });
                    
                    metroStations.appendChild(stationItem);
                });
            }
        }
        
        // Fun√ß√£o para selecionar uma esta√ß√£o
        function selectStation(transportType, line, station) {
            selectedOption = {
                type: transportType,
                line: line,
                station: station.name
            };
            
            // Obter localiza√ß√£o da esta√ß√£o
            stationLocation = {
                lat: station.lat,
                lng: station.lng,
                address: station.address
            };
            
            // Mostrar informa√ß√µes da localiza√ß√£o
            showStationLocationInfo();
            
            // Calcular dist√¢ncia inicial
            if (userLocation) {
                currentRealDistance = calculateDistance(userLocation.lat, userLocation.lng, stationLocation.lat, stationLocation.lng);
                updateDistanceDisplay();
            }
            
            // Atualizar status
            transportTypeEl.textContent = transportType === 'cptm' ? 'CPTM' : 'Metr√¥';
            selectedLineEl.textContent = line;
            selectedStationEl.textContent = station.name;
        }
        
        // Fun√ß√£o para mostrar informa√ß√µes da localiza√ß√£o da esta√ß√£o
        function showStationLocationInfo() {
            locationInfo.style.display = 'block';
            
            // Preencher informa√ß√µes da esta√ß√£o
            stationLat.textContent = stationLocation.lat.toFixed(6);
            stationLng.textContent = stationLocation.lng.toFixed(6);
            stationAddress.textContent = stationLocation.address;
            
            // Atualizar mapa
            mapCoordinates.textContent = `Coordenadas: ${stationLocation.lat.toFixed(6)}, ${stationLocation.lng.toFixed(6)}`;
            
            // Calcular e mostrar dist√¢ncia atual
            if (userLocation) {
                const distance = calculateDistance(userLocation.lat, userLocation.lng, stationLocation.lat, stationLocation.lng);
                realDistance.textContent = `${Math.round(distance)} metros`;
                
                // Atualizar barra de progresso (invertida: 0% = longe, 100% = perto)
                const progress = Math.max(0, Math.min(100, 100 - (distance / 1000) * 100));
                distanceProgress.style.width = `${progress}%`;
                
                // Verificar se est√° a 200 metros ou menos
                if (distance <= 200 && alarmEnabled) {
                    triggerAlarm(distance);
                }
            }
        }
        
        // Fun√ß√£o para calcular dist√¢ncia entre duas coordenadas (Haversine formula)
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371000; // Raio da Terra em metros
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c; // Dist√¢ncia em metros
        }
        
        // Fun√ß√£o para atualizar a exibi√ß√£o da dist√¢ncia
        function updateDistanceDisplay() {
            if (currentRealDistance >= 1000) {
                currentDistanceEl.textContent = `${(currentRealDistance / 1000).toFixed(2)} km`;
            } else {
                currentDistanceEl.textContent = `${Math.round(currentRealDistance)} metros`;
            }
            
            // Atualizar barra de progresso
            const progress = Math.max(0, Math.min(100, 100 - (currentRealDistance / 1000) * 100));
            distanceProgress.style.width = `${progress}%`;
            
            // Atualizar texto da dist√¢ncia real
            realDistance.textContent = `${Math.round(currentRealDistance)} metros`;
            
            // Verificar se est√° a 200 metros ou menos
            if (currentRealDistance <= 200 && alarmEnabled) {
                triggerAlarm(currentRealDistance);
            }
        }
        
        // Fun√ß√£o para mostrar op√ß√µes de endere√ßo
        function showOptions(type) {
            // Esconder todos os containers
            cptmLines.style.display = 'none';
            cptmStations.style.display = 'none';
            metroLines.style.display = 'none';
            metroStations.style.display = 'none';
            addressForm.style.display = 'none';
            locationInfo.style.display = 'none';
            selectionPath.style.display = 'none';
            
            // Limpar sele√ß√£o
            document.querySelectorAll('.option-item').forEach(el => el.classList.remove('selected'));
            selectedOption = null;
            selectedLine = null;
            stationLocation = null;
            
            // Mostrar o container correto
            if (type === 'address') {
                addressForm.style.display = 'block';
                transportTypeEl.textContent = 'Endere√ßo';
                selectedLineEl.textContent = 'Endere√ßo Cadastrado';
                selectedStationEl.textContent = 'Aguardando cadastro';
                currentSelectionStep = 'address';
            }
        }
        
        // Fun√ß√£o para confirmar sele√ß√£o
        function confirmSelection() {
            if (!selectedOption && currentSelectionStep !== 'address') {
                alert('Por favor, selecione uma esta√ß√£o primeiro!');
                return;
            }
            
            // Para endere√ßo, validar se os campos foram preenchidos
            if (currentSelectionStep === 'address') {
                if (!ruaInput.value || !numeroInput.value) {
                    alert('Por favor, preencha o endere√ßo completo!');
                    return;
                }
                
                selectedOption = {
                    type: 'endere√ßo',
                    line: 'Endere√ßo Cadastrado',
                    station: `${ruaInput.value}, ${numeroInput.value}`
                };
                
                selectedStationEl.textContent = `${ruaInput.value}, ${numeroInput.value}`;
                
                // Gerar localiza√ß√£o de destino aleat√≥ria (para simula√ß√£o)
                if (userLocation) {
                    stationLocation = {
                        lat: userLocation.lat + (Math.random() * 0.01 - 0.005),
                        lng: userLocation.lng + (Math.random() * 0.01 - 0.005),
                        address: `${ruaInput.value}, ${numeroInput.value}, ${bairroInput.value}, ${cidadeInput.value}`
                    };
                    
                    // Mostrar informa√ß√µes da localiza√ß√£o
                    showStationLocationInfo();
                }
            }
            
            alert(`Sele√ß√£o confirmada!\n\nTipo: ${selectedOption.type === 'cptm' ? 'CPTM' : selectedOption.type === 'metro' ? 'Metr√¥' : 'Endere√ßo'}\nLinha: ${selectedOption.line}\nEsta√ßao/Destino: ${selectedOption.station}\n\nO sistema ir√° alertar quando voc√™ estiver a 200 metros do destino.`);
            
            // Atualizar status
            currentDistanceEl.textContent = `${Math.round(currentRealDistance)} metros`;
            
            // Se o alarme est√° ativado, mostrar status
            if (alarmEnabled) {
                alarmStatus.className = "alarm-status alarm-active";
                alarmStatus.innerHTML = '<i class="fas fa-bell"></i> Alarme Ativado - Voc√™ ser√° alertado a 200 metros';
                alarmDistanceStatus.textContent = "Ativado (200m)";
            }
        }
        
        // Fun√ß√£o para obter localiza√ß√£o do usu√°rio
        function getUserLocation() {
            if (navigator.geolocation) {
                currentLocationEl.innerHTML = '<span class="loading"></span> Obtendo localiza√ß√£o...';
                
                // Usar geolocaliza√ß√£o real do navegador
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        userLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        
                        currentLocationEl.innerHTML = `<i class="fas fa-map-marker-alt"></i> Lat: ${userLocation.lat.toFixed(6)}, Long: ${userLocation.lng.toFixed(6)}`;
                        
                        // Se j√° tem uma esta√ß√£o selecionada, calcular dist√¢ncia
                        if (stationLocation) {
                            currentRealDistance = calculateDistance(userLocation.lat, userLocation.lng, stationLocation.lat, stationLocation.lng);
                            updateDistanceDisplay();
                        }
                    },
                    (error) => {
                        console.error("Erro ao obter localiza√ß√£o:", error);
                        // Usar localiza√ß√£o simulada em S√£o Paulo
                        userLocation = {
                            lat: -23.5505 + (Math.random() * 0.01 - 0.005),
                            lng: -46.6333 + (Math.random() * 0.01 - 0.005)
                        };
                        
                        currentLocationEl.innerHTML = `<i class="fas fa-map-marker-alt"></i> Lat: ${userLocation.lat.toFixed(6)}, Long: ${userLocation.lng.toFixed(6)} (simulado)`;
                    },
                    { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
                );
                
                // Atualizar localiza√ß√£o periodicamente
                setInterval(() => {
                    if (navigator.geolocation && isMonitoring) {
                        navigator.geolocation.getCurrentPosition(
                            (position) => {
                                userLocation = {
                                    lat: position.coords.latitude,
                                    lng: position.coords.longitude
                                };
                                
                                currentLocationEl.innerHTML = `<i class="fas fa-map-marker-alt"></i> Lat: ${userLocation.lat.toFixed(6)}, Long: ${userLocation.lng.toFixed(6)}`;
                                
                                // Se j√° tem uma esta√ß√£o selecionada, calcular dist√¢ncia
                                if (stationLocation) {
                                    currentRealDistance = calculateDistance(userLocation.lat, userLocation.lng, stationLocation.lat, stationLocation.lng);
                                    updateDistanceDisplay();
                                }
                            },
                            (error) => {
                                console.error("Erro ao atualizar localiza√ß√£o:", error);
                            },
                            { enableHighAccuracy: true, timeout: 5000 }
                        );
                    }
                }, 5000); // Atualizar a cada 5 segundos
                
            } else {
                currentLocationEl.textContent = "Geolocaliza√ß√£o n√£o suportada";
                // Usar localiza√ß√£o padr√£o
                userLocation = { lat: -23.5505, lng: -46.6333 };
            }
        }
        
        // Fun√ß√£o para ativar alarme
        function enableAlarm() {
            alarmEnabled = true;
            alarmStatus.className = "alarm-status alarm-active";
            alarmStatus.innerHTML = '<i class="fas fa-bell"></i> Alarme Ativado - Voc√™ ser√° alertado a 200 metros';
            alarmDistanceStatus.textContent = "Ativado (200m)";
            
            if (selectedOption) {
                alert(`Alarme ativado! Voc√™ ser√° alertado com som quando estiver a 200 metros de ${selectedOption.station}`);
            } else {
                alert('Alarme ativado! Selecione um destino para come√ßar a receber alertas.');
            }
        }
        
        // Fun√ß√£o para desativar alarme
        function disableAlarm() {
            alarmEnabled = false;
            alarmStatus.className = "alarm-status alarm-inactive";
            alarmStatus.innerHTML = '<i class="fas fa-bell-slash"></i> Alarme Desativado';
            alarmDistanceStatus.textContent = "Desativado";
            stopAllAlarms();
        }
        
        // Fun√ß√£o para acionar o alarme
        function triggerAlarm(distance) {
            if (!alarmEnabled) return;
            
            const alarmType = alarmSoundSelect.value;
            const alarmAudio = document.getElementById(alarmType);
            
            // Parar todos os alarmes primeiro
            stopAllAlarms();
            
            // Tocar o alarme selecionado
            alarmAudio.currentTime = 0;
            alarmAudio.play().catch(e => console.log("Erro ao tocar alarme:", e));
            
            // Mostrar notifica√ß√£o
            notificationMessage.textContent = `Voc√™ est√° se aproximando do destino!`;
            notificationDistance.textContent = `${Math.round(distance)} metros`;
            notificationDestination.textContent = selectedOption ? selectedOption.station : 'Destino selecionado';
            notification.style.display = 'block';
            
            // Vibrar se suportado
            if (navigator.vibrate) {
                navigator.vibrate([500, 200, 500, 200, 500]);
            }
            
            // Atualizar status
            alarmDistanceStatus.innerHTML = `<span class="distance-warning">ALERTA! ${Math.round(distance)}m</span>`;
        }
        
        // Fun√ß√£o para parar todos os alarmes
        function stopAllAlarms() {
            document.querySelectorAll('.alarm-sound').forEach(audio => {
                audio.pause();
                audio.currentTime = 0;
            });
        }
        
        // Fun√ß√£o para iniciar monitoramento autom√°tico
        function toggleMonitoring() {
            if (!selectedOption) {
                alert('Por favor, selecione uma esta√ß√£o primeiro!');
                return;
            }
            
            if (!isMonitoring) {
                isMonitoring = true;
                startMonitoringBtn.innerHTML = '<i class="fas fa-stop-circle"></i> Parar Monitoramento';
                startMonitoringBtn.classList.add('monitoring-active');
                simulationStatusEl.innerHTML = '<i class="fas fa-satellite-dish"></i> Monitoramento ativo - Aguardando aproxima√ß√£o a 200m';
                
                alert('Monitoramento ativado! O sistema verificar√° sua localiza√ß√£o automaticamente.');
            } else {
                isMonitoring = false;
                startMonitoringBtn.innerHTML = '<i class="fas fa-satellite-dish"></i> Iniciar Monitoramento em Tempo Real';
                startMonitoringBtn.classList.remove('monitoring-active');
                simulationStatusEl.innerHTML = 'Monitoramento desativado';
            }
        }
        
        // Fun√ß√£o para iniciar simula√ß√£o de viagem
        function startSimulation() {
            if (!selectedOption) {
                alert('Por favor, selecione e confirme um destino primeiro!');
                return;
            }
            
            if (simulationInterval) {
                clearInterval(simulationInterval);
            }
            
            // Resetar dist√¢ncia para simula√ß√£o (come√ßar a 1000m)
            currentRealDistance = 1000;
            updateDistanceDisplay();
            
            const speed = parseInt(simulationSpeed.value);
            simulationStatusEl.innerHTML = '<i class="fas fa-play-circle"></i> Simula√ß√£o em andamento... Aproximando-se do destino';
            simulateTripBtn.disabled = true;
            stopSimulationBtn.disabled = false;
            
            // Iniciar simula√ß√£o
            simulationInterval = setInterval(() => {
                // Reduzir dist√¢ncia gradualmente
                currentRealDistance -= Math.random() * 20 + 10; // Reduz 10-30 metros por intervalo
                
                if (currentRealDistance <= 0) {
                    currentRealDistance = 0;
                    clearInterval(simulationInterval);
                    simulationStatusEl.innerHTML = '<i class="fas fa-flag-checkered"></i> Voc√™ chegou ao destino!';
                    simulateTripBtn.disabled = false;
                    stopSimulationBtn.disabled = true;
                    
                    // Se chegou ao destino, parar alarmes
                    stopAllAlarms();
                    return;
                }
                
                // Atualizar display de dist√¢ncia
                updateDistanceDisplay();
                
                // Verificar se est√° a 200 metros ou menos
                if (currentRealDistance <= 200) {
                    simulationStatusEl.innerHTML = `<i class="fas fa-exclamation-triangle"></i> ALERTA: Voc√™ est√° a ${Math.round(currentRealDistance)} metros do destino!`;
                    
                    // Se o alarme est√° ativado, tocar
                    if (alarmEnabled && currentRealDistance <= 200) {
                        triggerAlarm(currentRealDistance);
                    }
                } else if (currentRealDistance <= 500) {
                    simulationStatusEl.innerHTML = `<i class="fas fa-info-circle"></i> Aproximando-se do destino: ${Math.round(currentRealDistance)} metros`;
                }
            }, speed); // Atualizar no intervalo selecionado
        }
        
        // Fun√ß√£o para parar simula√ß√£o
        function stopSimulation() {
            if (simulationInterval) {
                clearInterval(simulationInterval);
                simulationInterval = null;
            }
            
            simulationStatusEl.innerHTML = 'Simula√ß√£o interrompida';
            simulateTripBtn.disabled = false;
            stopSimulationBtn.disabled = true;
            stopAllAlarms();
            notification.style.display = 'none';
        }
        
        // Fun√ß√£o para formatar CEP
        function formatCEP() {
            let cep = cepInput.value.replace(/\D/g, '');
            
            if (cep.length > 5) {
                cep = cep.substring(0, 5) + '-' + cep.substring(5, 8);
            }
            
            cepInput.value = cep;
        }
        
        // Fun√ß√£o para buscar endere√ßo pelo CEP
        function fetchAddressByCEP() {
            const cep = cepInput.value.replace(/\D/g, '');
            
            if (cep.length !== 8) {
                alert('CEP inv√°lido! Digite um CEP com 8 d√≠gitos.');
                return;
            }
            
            // Mostrar indicador de carregamento
            ruaInput.value = "Buscando...";
            bairroInput.value = "Buscando...";
            cidadeInput.value = "Buscando...";
            estadoInput.value = "Buscando...";
            
            // Simula√ß√£o de busca de CEP
            setTimeout(() => {
                // Dados de exemplo para CEPs
                const cepExamples = {
                    '01001000': { logradouro: 'Pra√ßa da S√©', bairro: 'S√©', localidade: 'S√£o Paulo', uf: 'SP' },
                    '01311000': { logradouro: 'Avenida Paulista', bairro: 'Bela Vista', localidade: 'S√£o Paulo', uf: 'SP' },
                    '20040002': { logradouro: 'Rua Primeiro de Mar√ßo', bairro: 'Centro', localidade: 'Rio de Janeiro', uf: 'RJ' },
                    '30130005': { logradouro: 'Rua da Bahia', bairro: 'Centro', localidade: 'Belo Horizonte', uf: 'MG' },
                    '40010000': { logradouro: 'Rua Chile', bairro: 'Centro', localidade: 'Salvador', uf: 'BA' },
                    '70040900': { logradouro: 'Eixo Monumental', bairro: 'Asa Sul', localidade: 'Bras√≠lia', uf: 'DF' }
                };
                
                // Usar exemplo se existir, caso contr√°rio usar dados gen√©ricos
                let endereco;
                
                if (cepExamples[cep]) {
                    endereco = cepExamples[cep];
                } else {
                    // Dados gen√©ricos para qualquer CEP
                    const cidades = [
                        { cidade: 'S√£o Paulo', uf: 'SP' },
                        { cidade: 'Rio de Janeiro', uf: 'RJ' },
                        { cidade: 'Belo Horizonte', uf: 'MG' },
                        { cidade: 'Porto Alegre', uf: 'RS' },
                        { cidade: 'Curitiba', uf: 'PR' },
                        { cidade: 'Salvador', uf: 'BA' }
                    ];
                    
                    const cidadeSelecionada = cidades[Math.floor(Math.random() * cidades.length)];
                    
                    endereco = {
                        logradouro: `Rua Exemplo ${Math.floor(Math.random() * 1000)}`,
                        bairro: 'Centro',
                        localidade: cidadeSelecionada.cidade,
                        uf: cidadeSelecionada.uf
                    };
                }
                
                // Preencher os campos
                ruaInput.value = endereco.logradouro;
                bairroInput.value = endereco.bairro;
                cidadeInput.value = endereco.localidade;
                estadoInput.value = endereco.uf;
                
                // Focar no campo de n√∫mero
                numeroInput.focus();
                
            }, 800); // Simular delay de rede
        }
    </script>
</body>
</html>